{% extends "page.html" %}

{% block subtitle %}{{ c.workflow_dict.name }} - {{ _('Workflows') }}{% endblock %}

{% block breadcrumb_content %}
  <li>{% link_for _('Workflows'), controller='ckanext.tess.workflow:WorkflowController', action='index' %}</li>
  <li>{% link_for c.workflow_dict.name|truncate(35), controller='ckanext.tess.workflow:WorkflowController', action='read', id=c.workflow_dict.id %}</li>
  <li class="active">{% link_for _('Manage'), controller='ckanext.tess.workflow:WorkflowController', action='update', id=c.workflow_dict.id %}</li>
{% endblock %}

{% block content_action %}
<div style="margin-bottom: 13px;">
    {% link_for _('View'), controller='ckanext.tess.workflow:WorkflowController', action='read', id=c.workflow_dict.id, class_='btn', icon='eye-open' %}
</div>
{% endblock %}

{% block primary_content_inner %}
    {% if c.workflow_dict.definition %}
        {% snippet "workflow/snippets/display_workflow_info.html", workflow=c.workflow_dict, action='edit' %}
        {% snippet "workflow/snippets/display_workflow.html", workflow=c.workflow_dict.definition, action='edit' %}
    {% else %}
        {% snippet "workflow/snippets/display_workflow_info.html", workflow=c.workflow_dict, action='edit' %}
        {% snippet "workflow/snippets/display_workflow.html", workflow={}, action='new' %}
    {% endif %}
{% endblock %}

{% block secondary_content %}
    <div class="module module-narrow module-shallow context-info">
        <section class="module-content">
    {% block heading %}
         <h1 class="heading">{{c.workflow_dict.name}}</h1>
    {% endblock %}
    {% if c.workflow_dict.description %}
        <p>{{ h.markdown_extract(c.workflow_dict.description, 180) }}</p>
    {% else %}
        <p class="empty">{{ _('There is no description for this workflow') }}</p>
    {% endif %}
        </section>
    </div>
    {% snippet "workflow/snippets/workflow-creation-guide.html" %}
    {% snippet "workflow/snippets/workflow-property-editor.html" %}
{% endblock %}
